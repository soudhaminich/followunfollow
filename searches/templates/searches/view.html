{% extends "blogs/base_question.html" %}
{% load humanize %}
{% block title %}
Teckiy - Search
{% endblock %}
{% load support_extras %}
{% load static %}
{% block content %}

<div class="row grid1 mt-5">
    <div class="col-lg-2 d-lg-block d-none pl-2 pr-1">
        {% include "blogs/leftnav.html" %}
    </div>
    <div class="col-lg-8 col-12 pl-0 pb-0 pr-4">
        <div class="d-lg-flex" style="height:100%;">

            <!-- signed out alert message -->

            <div class="pt-4 pl-4 w-100">
                {% if messages %}
                {% for message in messages %}
                <div style="border-radius: 25px;"
                    class="text-center prior-font font-weight-bold alert alert-{{ message.tags }} alert-dismissible"
                    role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                {% endfor %}
                {% endif %}

                <!-- signed out alert message -->
                <!-- all-tkts-scrollable sctn -->
                <div class="d-flex flex-wrap pt-3 mb-4">
                    <h1 class=" prior-font text-dark all-tkt-fs mr-auto">You searched for <span class="text-danger prior-font font-weight-bold">{{ query }}</span></h1>
                    <div class="d-flex flex-wrap flex-column">
                        <form class="mb-3 text-center" action="{% url 'support:create' %}">
                            <a class="text-decoration-none bg-primary text-white p-2 fs_teen rounded"
                                href="{% url 'support:create' %}">Submit Ticket</a>
                        </form>
                    </div>
                </div>

                <!-- filter design -->

                <!-- end of filter design -->
                {% if not object_list %}
                <hr class="m-0 p-0">
                <div class="text-center mt-4">
                    <img height=150 width=100 src="{% static 'blogs/images/magnifying-glass.png' %}" alt="">
                </div>
                <h3 class="prior-font text-center">No Results Found</h3>
                <p class="text-center text-muted">No Questions matched with your searched result <br> Try Again!!</p>
                {% endif %}

                {% for obj in object_list %}
                <div class="bg-white rounded question-list-component mb-4 p-3 wordwrap">
                    <div class="d-flex flex-wrap">
                        <div class="mt-auto">
                            <img class="rounded mr-2 mb-2" style="width:60px; height:60px; "
                                src="{{ obj.user.profile.image.url }}">
                        </div>
                        <div class="mr-auto">
                            <a style="font-size:15px;" class="text-decoration-none prior-font"
                                href="{% url 'users:profile' obj.user.username %}">{{ obj.user.username }}</a>
                            <div class="text-muted fs">asked {{ obj.date_posted|naturaltime }}</div>
                            <!-- for small screens views visibility -->
                            <div class="text-muted fs d-sm-none d-block">{% if obj.objectviewed_set.count > 0 %}
                                Views <strong>{{ obj.objectviewed_set.count }}</strong>
                                {% else %}
                                Views <strong>1</strong>
                                {% endif %}
                            </div>

                        </div>
                        <div class="d-flex flex-column">
                            <!-- price display for high tkt -->
                            {% if obj.priority == 'H' %}
                            <span class="font-weight-bold text-success text-center" style="font-size:18px;">$5
                                <!-- <span class="text-muted" style="font-size:18px;">USD</span> -->
                            </span>
                            {% endif %}
                            <!-- price display for urgent tkt -->
                            {% if obj.priority == 'U' %}
                            <span class="font-weight-bold mr-2" style="font-size:18px; color:green;">$10</span>
                            {% endif %}
                            <!-- for large screens views visibility -->
                            <div class="text-muted fs d-sm-block d-none">
                                {% if obj.objectviewed_set.count > 0 %}
                                Views <strong>{{ obj.objectviewed_set.count }}</strong>
                                {% else %}
                                Views <strong>1</strong>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="mb-4 wordwrap">
                        <div class="mt-3 d-flex flex-wrap wordwrap">
                            <a class="text-decoration-none prior-font mr-auto wordwrap "
                                href="{{ obj.get_absolute_url  }}">{{ obj.title }}</a>
                        </div>
                        <div class="fs_teen mt-2 all-tklist-des" style="word-wrap: break-word;">
                            {{ obj.content|safe|truncatewords_html:20}}
                        </div>
                    </div>
                    <div class="d-flex flex-wrap flex-column flex-sm-row">
                        <a style="background-color: #e1ecf4;"
                            class="mr-auto mb-2 text-decoration-none fs_teen p-1 rounded"
                            href="">{{ obj.get_category_display }}</a>
                        <div class="d-flex flex-wrap">
                            <div class="fs_teen mr-2 mt-1">
                                {% if obj.priority == 'H' %}
                                <span class="text-danger text-center">{{ obj.get_priority_display }}</span>
                                {% endif %}
                                {% if obj.priority == 'U' %}
                                <span class="text-danger text-center">{{ obj.get_priority_display }}</span>
                                {% endif %}
                                {% if obj.priority == 'L' %}
                                <span class="text-success">{{ obj.get_priority_display }}</span>
                                {% endif %}
                                {% if obj.priority == 'M' %}
                                <span class="text-info">{{ obj.get_priority_display }}</span>
                                {% endif %}
                            </div>
                            <div class="fs_teen mr-2 mt-1">
                                <span class="text-secondary">{{ obj.get_ticket_type_display }}</span>
                            </div>
                            <div class="fs_teen mr-2 mt-1">
                                {% if obj.status == 'I'  %}
                                <span class="bg-warning p-1 rounded">{{ obj.get_status_display  }}</span>
                                {% endif %}
                                {% if obj.status == 'C'  %}
                                <span class="bg-danger p-1 rounded text-white">{{ obj.get_status_display  }}</span>
                                {% endif %}
                                {% if obj.status == 'O'  %}
                                <span class="bg-success p-1 rounded text-white">{{ obj.get_status_display  }}</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
                <!-- Pagination -->
                {% if is_paginated %}

                {% if page_obj.has_previous %}
                <a class="btn btn-outline-primary mb-4"
                    href="?{% paginate_url 'page' 1 request.GET.urlencode %}">First</a>
                <a class="btn btn-outline-primary mb-4"
                    href="?{% paginate_url 'page' page_obj.previous_page_number request.GET.urlencode %}">Previous</a>
                {% endif %}

                {% for num in page_obj.paginator.page_range %}
                {% if page_obj.number == num %}
                <a class="btn  btn-primary mb-4"
                    href="?{% paginate_url 'page' num request.GET.urlencode %}">{{ num }}</a>
                {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <a class="btn  btn-outline-primary mb-4"
                    href="?{% paginate_url 'page' num request.GET.urlencode %}">{{ num }}</a>
                {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                <a class="btn btn-outline-primary mb-4"
                    href="?{% paginate_url 'page' page_obj.next_page_number request.GET.urlencode %}">Next</a>
                <a class="btn  btn-outline-primary mb-4"
                    href="?{% paginate_url 'page' page_obj.paginator.num_pages request.GET.urlencode %}">Last</a>
                {% endif %}
                {% endif %}
                <!-- End of Pagination-->
            </div>
        </div>
        <br>

    </div>
    <!-- end of center section -->

    <!-- Blogs, Ads, FAQ's section -->
    <div class="col-lg-3 col-12 p-0 pb-0 pt-2  text-center right-fixed-cards-sctn">
        {% include "blogs/home_content.html" %}
    </div>
</div>

{% endblock %}
{% block extrajs %}


{% endblock extrajs %}